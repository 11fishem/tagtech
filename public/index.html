<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="stuff, to, help, search, engines, not" name="keywords">
<meta content="What this page is about." name="description">
<meta content="Display Webcam Stream" name="title">
<title>Display Webcam Stream</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://aframe.io/releases/0.6.1/aframe.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCE3SPYU11vda-IQXwXoW4wDF6WzmAE7EI&callback=initGeolocation" async defer></script>
<script src="js/MAP.js"></script>

<style>
  a-scene {
  position: absolute;
  top:0px;
  left:0px;
  width: 100%;
  height: 100%;
}
#container {
    position: absolute;
    margin: 0px;
    width: 100%;
    height: 100%;
}
#videoElement {
    position: absolute;
    width: 100%;
    height: 100%;
    background-color: #666;
}
</style>
<script type="text/javascript">

function() {

}



function initGeolocation() {
  if (navigator && navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
        } else {
            console.log('Geolocation is not supported');
        }
}

function errorCallback() {}

function successCallback(position) {
      var mapUrl = "http://maps.google.com/maps/api/staticmap?center=";
      mapUrl = mapUrl + position.coords.latitude + ',' + position.coords.longitude;
      mapUrl = mapUrl + '&zoom=15&size=512x512&maptype=roadmap&sensor=false';
      var imgElement = document.getElementById("map");
      console.log(imgElement); //:)
      imgElement.setAttribute('material','src', mapUrl );
    }
</script>
</head>

<body>
<div id="container">
    <video autoplay="true" id="videoElement">

    </video>
</div>
<a-scene onload="javascript:initGeolocation()">
  <a-entity camera look-controls map-component>
    <a-entity id="map" geometry="primitive:plane" position="0 0 -1.1" rotation="-10 0 0" visible="false"  material="shader: flat; src: https://cdn.glitch.com/b4aaa609-f9dc-4ddc-b249-595ab6428aea%2Fearth-sumner.jpg?1499064390768"></a-entity>
  </a-entity>
  <a-sound volume="1" src="src: url(https://cdn.glitch.com/b4aaa609-f9dc-4ddc-b249-595ab6428aea%2Fscary%20heartbeat%20-%20sound%20effect.mp3?1503180767176)" autoplay="true" position="10 10 10" loop="true">
    <a-animation attribute="position"
               dur="10000"
               fill="forwards"
               to="0 0 0"
               repeat="indefinite"></a-sound>
</a-scene>
<script>
var video = document.querySelector("#videoElement");

navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia;


if (navigator.getUserMedia) {
  // Request the camera.
  navigator.getUserMedia(
    // Constraints
    {
    audio: false, video: { facingMode: { exact: "environment" } }
    },

    // Success Callback
    function(localMediaStream) {

    video.src = window.URL.createObjectURL(localMediaStream);
    },

    // Error Callback
    function(err) {
      // Log the error to the console.
      console.log('The following error occurred when trying to use getUserMedia: ' + err);
    }
  );

} else {
  alert('Sorry, your browser does not support getUserMedia');
}
</script>

</body>
</html>